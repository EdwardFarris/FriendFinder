<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>FriendFinder Survey</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>


</head>

<body>

    <div class="container">

        <h2>Survey Questions</h2>
        <hr>

        <h3><strong>About You</strong></h3>

        <h4>Name (Required)</h4>
        <input type="text" id="name" class="validate" required="">

        <h4>Link to Photo Image (Required)</h4>
        <input type="text" id="photo" class="validate" required="">
        <hr>

        <h3><strong>Question 1</strong></h3>
        <h4>You enjoy doing outdoor activities like hiking and camping.</h4>
        <select class="custom-select" id="q1">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 2</strong></h3>
        <h4>You have a passion for music.</h4>
        <select class="custom-select" id="q2">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 3</strong></h3>
        <h4>You have strong religious and/or spiritual beliefs.</h4>
        <select class="custom-select" id="q3">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 4</strong></h3>
        <h4>You have a desire to explore the world and love to travel.</h4>
        <select class="custom-select" id="q4">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 5</strong></h3>
        <h4>You love to excercise your creativity and solve problems.</h4>
        <select class="custom-select" id="q5">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 6</strong></h3>
        <h4>Your favorite movie genre is comedy.</h4>
        <select class="custom-select" id="q6">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 7</strong></h3>
        <h4>You have a firm belief in science.</h4>
        <select class="custom-select" id="q7">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 8</strong></h3>
        <h4>You have conservative political views and beliefs.</h4>
        <select class="custom-select" id="q8">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 9</strong></h3>
        <h4>You enjoy a wide variety of foods and are not a picky eater.</h4>
        <select class="custom-select" id="q9">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 10</strong></h3>
        <h4>You are a fitness freak and love to workout.</h4>
        <select class="custom-select" id="q10">
            <option value="">select a value here</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <br>
        <br>
        <button type="submit" id="submitBtn" class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target="myModal">Submit
            Response and Find a Match!</button>

        <footer class="footer">
            <div class="container">
                <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/EdwardFarris/FriendFinder"
                        target="_blank">GitHub Repo</a>
            </div>
        </footer>

    </div>

    <!-- modal -->
    <div class="modal" tabindex="-1" role="dialog" id="myModal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">FriendFinder!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h4>Here is your new friend suggestion!</h4>
                    <h5 id="matchName"></h5>
                    <img id="matchPic" src="" alt="No Image" width=250px>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">

        $(document).ready(function () {
            $("#submitBtn").on("click", function (event) {
                event.preventDefault();
                //validate form information
                function validateForm() {
                    let isValid = true;
                    $(".validate").each(function () {
                        if ($(this).val() === "") {
                            isValid = false;
                        }
                    });

                    $(".custom-select").each(function () {
                        if ($(this).val() === "") {
                            isValid = false;
                        }
                    });
                    return isValid
                }

                //if all form values are filled
                if (validateForm() == true) {
                    // Here we grab the form elements
                    const newFriend = {
                        name: $("#name").val().trim(),
                        photo: $("#photo").val().trim(),
                        scores: [
                            ($("#q1").val()),
                            ($("#q2").val()),
                            ($("#q3").val()),
                            ($("#q4").val()),
                            ($("#q5").val()),
                            ($("#q6").val()),
                            ($("#q7").val()),
                            ($("#q8").val()),
                            ($("#q9").val()),
                            ($("#q10").val()),
                        ]
                    };
                    // This line is the magic. It"s very similar to the standard ajax function we used.
                    // Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
                    // The callback is the response of the server. In our case, we set up code in api-routes that "returns" true or false
                    // depending on if a tables is available or not.

                    $.post("/api/friends", newFriend,
                        function (data) {
                            $("#matchName").text(data.name);
                            $("#matchPic").attr("src", data.photo)
                        });

                    //display modal with the match result
                    $('#myModal').modal('show');
// Clear the form when submitting
                    // $("#name").val(""),
                    //     $("#photo").val(""),
                    //     $("#q1").val(""),
                    //     $("#q2").val(""),
                    //     $("#q3").val(""),
                    //     $("#q4").val(""),
                    //     $("#q5").val(""),
                    //     $("#q6").val(""),
                    //     $("#q7").val(""),
                    //     $("#q8").val(""),
                    //     $("#q9").val(""),
                    //     $("#q10").val("")
                } else {
                    alert("Please fill out ALL fields before submitting survey!")
                }
            });
        });
 </script>

</body>

</html>